import requests

# get html object(text) with split(\n)
content = requests.get('https://rhn.redhat.com/errata/rhel-server-6-errata.html').text.split('\n')

# grep errataTableData
data_def = ''
for line in content:
    if 'errataTableData' in line:
        data_def = line
        break

# generate a char array from the HTML
char_arr = []
prev = ''
write_to_arr = False
# iterate by a character
for char in data_def:
    if write_to_arr:
        char_arr.append(char)
    if char == '[' and prev == '[':
        write_to_arr = True
    if char == ']' and prev == ']':
        write_to_arr = False
    prev = char

# join array up into string
data_str = '[[' + ''.join(char_arr)

# clean up the data so it's in a csv with every line containing a row
formatted = data_str.replace('[[', '[')\
                    .replace(']]', ']')\
		            .replace('],[', ']\n[')\
                    .replace(']', '')\
                    .replace('[', '')\

# write to file
open('rhel_table_data.csv', 'w+').write(formatted)
